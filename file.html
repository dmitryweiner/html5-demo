<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>File</title>
    <style type="text/css">
        #dropZone {
            border: 5px solid blue;
            width: 400px;
            height: 200px;
        }
    </style>
    <link rel="stylesheet" type="text/css" href="files/default.css"/>
    <script type="application/javascript">
        document.addEventListener("DOMContentLoaded", () => {

            function handleSimpleFileInput(event) {
                logs.innerHTML = "";
                picturesHolder.innerHTML = "";
                for (let file of simpleInput.files) {
                    switch(file.type){
                        case 'audio/mpeg': createAudioFromFile(file); break;
                        case 'image/jpeg': createPictureFromFile(file); break;
                        case 'video/mp4': createVideoFromFile(file); break;
                    }
                    logs.innerHTML += `File name: ${file.name}, file size: ${file.size}.\n`;
                }
            }

            function dropHandler(ev) {
                console.log('File(s) dropped');

                // Prevent default behavior (Prevent file from being opened)
                ev.preventDefault();

                if (ev.dataTransfer.items) {
                    // Use DataTransferItemList interface to access the file(s)
                    for (let file of ev.dataTransfer.items) {
                        // If dropped items aren't files, reject them
                        switch(file.type){
                            case 'audio/mpeg': createAudioFromFile(file.getAsFile()); break;
                            case 'image/jpeg': createPictureFromFile(file.getAsFile()); break;
                            case 'video/mp4': createVideoFromFile(file.getAsFile()); break;
                        }
                    }
                }
            }
        }

            function createPictureFromFile(file) {
                const image = document.createElement('img');
                image.src = URL.createObjectURL(file);
                picturesHolder.appendChild(image);
            }

            function createAudioFromFile(file) {
                const audio = document.createElement('audio');
                audio.controls = "controls";
                const source = document.createElement('source');
                audiosHolder.appendChild(audio);
                audio.appendChild(source)
                source.src = URL.createObjectURL(file);
                audio.load();
            }

            function createVideoFromFile(file) {
                const video = document.createElement('video');
                video.controls = "controls";
                const source = document.createElement('source');
                videosHolder.appendChild(video);
                video.appendChild(source);
                source.src = URL.createObjectURL(file);
                video.load();
            }


            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            const simpleInput = document.getElementById("simpleInput");
            const logs = document.getElementById("logs");
            const picturesHolder = document.getElementById("picturesHolder");
            const dropZone = document.getElementById("dropZone");
            const audiosHolder = document.getElementById("audioHolder");
            const videosHolder = document.getElementById("videoHolder");
            simpleInput.addEventListener("change", handleSimpleFileInput);
            dropZone.addEventListener("drop", dropHandler, false);

            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults, false);
                document.body.addEventListener(eventName, preventDefaults, false);
            })
        };
    </script>
</head>
<body>
<div id="wrapper">
    <h1>File upload</h1>
    <input id="simpleInput" type="file" multiple accept=".jpg, .jpeg, .png"/>
    <br/>
    <br/>
    <div id="dropZone">
        <p>Drag one or more files to this Drop Zone ...</p>
    </div>
    <br/>
    <br/>
    <textarea id="logs" rows="4" cols="80"></textarea>
    <br/>
    <br/>
    <div id="picturesHolder">
    </div>
    <br/>
    <br/>
    <div class="audioHolder">
    </div>
    <br/>
    <br/>
    <div class="videoHolder">
    </div>

</div>
</body>
</html>
